{"version":3,"file":"daType.js","sources":["../../../../../../node_modules/@openenergytools/scl-template-validator/dist/validators/daType.js"],"sourcesContent":["import { iec6185073, iec6185081, validateChildren, } from \"../foundation.js\";\nasync function getChildren(cdc, daName) {\n    const nsd73 = await iec6185073;\n    const dataAttribute = nsd73\n        .querySelector(`CDC[name=\"${cdc}\"] > DataAttribute[name=\"${daName}\"]`)\n        ?.getAttribute(\"type\");\n    return Array.from(nsd73.querySelectorAll(`ConstructedAttributes > ConstructedAttribute[name=\"${dataAttribute}\"] > SubDataAttribute[presCond=\"M\"]`));\n}\nasync function getServiceChildren(daName) {\n    const nsd81 = await iec6185081;\n    return Array.from(nsd81.querySelectorAll(`ServiceConstructedAttributes > ServiceConstructedAttribute[name=\"${daName}\"] > ` +\n        ` SubDataAttribute[presCond=\"M\"]`));\n}\nasync function getMandatoryChildren(daType) {\n    const id = daType.getAttribute(\"id\");\n    if (!id)\n        return [];\n    const dataAttribute = daType\n        .closest(\"DataTypeTemplates\")\n        ?.querySelector(`DOType > DA[type=\"${id}\"]`);\n    const daName = dataAttribute?.getAttribute(\"name\");\n    if (daName && [\"Oper\", \"SBOw\", \"SBO\", \"Cancel\"].includes(daName))\n        return getServiceChildren(daName);\n    const cdc = dataAttribute?.parentElement?.getAttribute(\"cdc\");\n    return getChildren(cdc, daName);\n}\nasync function missingMandatoryChildren(daType) {\n    const mandatoryChildren = await getMandatoryChildren(daType);\n    const mandatoryChildNames = mandatoryChildren.map((DA) => DA.getAttribute(\"name\"));\n    const missingDaNames = mandatoryChildNames.filter((da) => !daType.querySelector(`BDA[name=\"${da}\"]`));\n    return missingDaNames.map((missingDa) => ({\n        title: `Missing mandatory child data attribute ${missingDa}`,\n        message: `${daType.getAttribute(\"id\")}`,\n    }));\n}\nexport async function dATypeValidator(daType) {\n    const errors = [];\n    if (daType.tagName !== \"DAType\")\n        return [];\n    const missingChildren = await missingMandatoryChildren(daType);\n    const issuesChildren = await validateChildren(daType);\n    return errors.concat(missingChildren, issuesChildren);\n}\n//# sourceMappingURL=daType.js.map"],"names":[],"mappings":"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"}